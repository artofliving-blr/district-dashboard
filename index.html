<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>AOL District Dashboard</title>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.1.1/crypto-js.min.js"></script>
    <style>
    .card { transition: 0.3s; cursor: pointer; border-radius: 12px; }
    .card:hover { transform: translateY(-5px); box-shadow: 0 12px 24px rgba(0,0,0,0.2) !important; }
    
    /* Ensure horizontal rules inside colored cards look clean */
    .bg-success hr, .bg-danger hr { border-top: 1px solid rgba(255,255,255,0.3); }
    .bg-warning hr { border-top: 1px solid rgba(0,0,0,0.1); }
    .logo {
            width: 150px;
            display: block;
            margin: 27px auto 7px auto;
        }
    .btn-outline-secondary, .btn-outline-success {
        border-radius: 50%;
        width: 32px;
        height: 32px;
        padding: 0;
        line-height: 30px;
        text-align: center;
        font-size: 14px;
    }
    /* NEW: Mini Pie Chart Styles */
    .pie-chart-container {
        background: rgba(255,255,255,0.1); /* Slight background for contrast */
        border-radius: 8px;
        padding: 10px;
        margin-top: 15px;
    }
    .pie-chart {
        width: 40px;
        height: 40px;
        border-radius: 50%;
        border: 2px solid rgba(255,255,255,0.5);
        /* The actual pie slices will be set via inline styles in JS */
    }
    .chart-legend { font-size: 0.75rem; line-height: 1.3; }
    
    /* Sidebar Layout */
    body {
        margin: 0;
        padding: 0;
    }
    .main-layout {
        display: flex;
        gap: 20px;
        padding: 0 15px;
        max-width: 100%;
    }
    .sidebar {
        flex: 0 0 280px;
        background: #f8f9fa;
        padding: 20px;
        border-radius: 12px;
        box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        height: fit-content;
        position: sticky;
        top: 20px;
    }
    .main-content {
        flex: 1;
        min-width: 0;
    }
    .full-width-container {
        max-width: 100%;
        padding: 0 15px;
    }
    @media (max-width: 768px) {
        .main-layout {
            flex-direction: column;
            padding: 0 10px;
        }
        .sidebar {
            flex: 1;
            position: static;
            margin-bottom: 20px;
        }
        .full-width-container {
            padding: 0 10px;
        }
    }
</style>
</head>
<body>
    <img src="Art-of-Living_Logo.png" alt="Art of Living Logo" class="logo">
    <div class="full-width-container py-3">
    <div class="text-center mb-5">
        <h1 class="display-4 font-weight-bold">Karnataka District Activity Tracker</h1>
        <h3 class="text-secondary mb-3">
            <div class="alert alert-info" role="alert">
            (Jan 15, 2026 to May 31, 2026)
            </div>
        </h3>
        <p id="last-updated-text" class="text-muted font-italic mb-3">Loading timestamp...</p>
        <div class="btn-group btn-group-toggle mb-4 shadow-sm" data-toggle="buttons">
            <label class="btn btn-warning" id="district_label">
                <input type="radio" name="view" onclick="showView('district')" checked> District Dashboard
            </label>
            <label class="btn btn-outline-warning" id="state_label">
                <input type="radio" name="view" onclick="showView('state')"> State Summary
            </label>
        </div>
        <div id="state-summary-container" class="mb-5" style="display:none;"></div>
    </div>

    <div class="main-layout">
        <div class="sidebar" id="filter-controls">
            <div class="custom-control custom-checkbox mb-4">
                <input type="checkbox" class="custom-control-input" id="sortTopCheck" onchange="toggleSort()">
                <label class="custom-control-label font-weight-bold" for="sortTopCheck">Sort by Top Performing</label>
            </div>
            
            <div class="mb-4">
                <div class="btn-group-vertical w-100" role="group">
                    <button type="button" class="btn btn-primary" id="btn-all" onclick="setFilter('all')">All Programs</button>
                    <button type="button" class="btn btn-outline-primary" id="btn-entry" onclick="setFilter('entry')">Entry Level Only</button>
                </div>
            </div>
            
            <div class="alert alert-info" role="alert">
                <small>Click on a district to view course timelines and registration links.</small>
            </div>
        </div>
        
        <div class="main-content">
            <div class="row" id="dashboard-container"></div>
        </div>
    </div>
    
    <div class="full-width-container">
        <div id="detail-view" class="mt-5 card shadow p-4" style="display:none;">
            <h3 id="detail-title" class="mb-4"></h3>
            <div class="table-responsive">
                <table class="table table-bordered">
                    <thead class="thead-dark">
                        <tr>
                            <th>Status</th>
                            <th>Course</th>
                            <th>Pax</th>
                            <th>Teachers</th>
                            <th>Starts On</th>
                            <th>Action</th>
                        </tr>
                    </thead>
                    <tbody id="detail-table-body"></tbody>
                </table>
            </div>
        </div>
    </div>
    <script src="app.js"></script>
</body>
</html>